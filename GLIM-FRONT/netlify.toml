# Netlify 설정 파일: API 요청을 백엔드 서버로 전달(proxy)합니다.

[build]
  command   = "next build"
  publish   = ".next"
  functions = "netlify/functions"

[functions]
  node_bundler = "esbuild"  # TypeScript 함수 번들

# 프론트에서 호출하는 /api/* 을 함수로 라우팅
[[redirects]]
  from   = "/api/*"
  to     = "/.netlify/functions/proxy/:splat"
  status = 200
  force  = true

# (옵션) 혹시 /v1/*로 직접 부르면 => 함수에 'api/' 접두 붙여서 넘김
#   /v1/xxx 요청 → /.netlify/functions/proxy/api/xxx → 최종 /api/v1/xxx 백엔드 호출

[[redirects]]
  from   = "/v1/*"
  to     = "/.netlify/functions/proxy/api/:splat"
  status = 200
  force  = true

[[redirects]]
from   = "/images/*"
to     = "http://i13d202.p.ssafy.io:8080/images/:splat"
status = 200
force  = true

[[plugins]]
  package = "@netlify/plugin-nextjs"
